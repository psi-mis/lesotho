{"system":{"id":"e474f7d2-98b5-484e-901e-e0feb955b2ea","rev":"c12aa62","version":"2.25","date":"2017-06-29T08:31:36.532"},"sqlViews":[

{"created":"2017-06-22T05:22:22.500","lastUpdated":"2017-06-29T06:40:27.125","name":"LSDescoveryAndDesign_ARTRefer_AllFollowUp","id":"I8xOsd6qfyh","sqlQuery":"select DISTINCT ON(pi.programinstanceid)\r\n tei.uid\r\n\r\n-- [HIV Testing]\r\n, psi.uid as hiveventid\r\n, psi.executiondate\r\n, extract(day from (\r\n    date 'now()' - psi.executiondate \r\n) )  as daySinceDiagnosis\r\n\r\n-- TEI attribute values\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='rw3W9pDCPb2' ) as cuic\r\n\r\n-- [Contact Log] event\r\n, contactlogevent.executiondate as contactlogevent_date\r\n, contactlogevent.name as lastaction\r\n, nextactionduedate.value as nextactiondate\r\n, nextaction.name as nextaction\r\n, contactlogevent.username as contactlogevent_username\r\n\r\n-- [ART Opening] event\r\n, artopeningfacility.executiondate\r\n, ( select optval.name || '***' || optval.code from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=_tea.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='NLNTtpbT3c5' and optval.code=_teav.value ) as counsil\r\n, artopeningfacility.value as facility\r\n, artopeningotherfacility.value as otherfacility\r\n\r\n-- [ART Closure] event\r\n, artclosureeventdata.executiondate as artclosureeventdate\r\n, artclosureeventdata.name as artclosureevent_linkageoutcome\r\n, artclosureeventdata.username as artclosureusername\r\n\r\n\r\nfrom programstageinstance psi\r\ninner join organisationunit org on org.organisationunitid=psi.organisationunitid\r\ninner join programinstance pi on pi.programinstanceid=psi.programinstanceid\r\ninner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid\r\n\r\n\r\n\r\nleft outer join ( select artopeningevent.value, _pi.programinstanceid, _psi.executiondate\r\n\t\tfrom trackedentitydatavalue as artopeningevent\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=artopeningevent.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=artopeningevent.dataelementid and de.uid = 'UuKat0HFjWS' ) as positiveEvent\r\n\ton positiveEvent.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select optval.name as value, _pi.programinstanceid, _psi.executiondate\r\n\t\tfrom trackedentitydatavalue as artopeningevent\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=artopeningevent.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=artopeningevent.dataelementid and de.uid = 'E1KAxdya3y5' \r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid and optval.code=artopeningevent.value ) as artopeningfacility\r\n\ton artopeningfacility.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select artopeningevent.value, _pi.programinstanceid, _psi.executiondate\r\n\t\tfrom trackedentitydatavalue as artopeningevent\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=artopeningevent.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=artopeningevent.dataelementid and de.uid = 'CLclHLxzl9e' ) as artopeningotherfacility\r\n\ton artopeningotherfacility.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select optval.name, _pi.programinstanceid, _psi.programstageinstanceid, _psi.executiondate, catOption.code as username\r\n\t\tfrom programstageinstance _psi\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='usEIFQODMxf'\r\n\t\t\t\tinner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=_psi.attributeoptioncomboid\r\n\t\t\t\tinner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\n\t\t\t\tinner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid\r\n\t\t\t\tinner join trackedentitydatavalue _tedv on _tedv.programstageinstanceid=_psi.programstageinstanceid\r\n\t\t\t\tinner join dataelement _de on _de.dataelementid=_tedv.dataelementid and _de.uid = 'nOK8JcDWT9X'\r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=_de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid and optval.code=_tedv.value\r\n\t\t) as artclosureeventdata\r\n\ton artclosureeventdata.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select optval.name, _pi.programinstanceid, _psi.executiondate, catOption.code as username\r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid\r\n\t\t\t\tinner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=_psi.attributeoptioncomboid\r\n\t\t\t\tinner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\n\t\t\t\tinner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid and de.uid = 'wzM3bUiPowS' \r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid and optval.code=contactlog.value\r\n) as contactlogevent\r\n\ton contactlogevent.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select optval.name, _pi.programinstanceid \r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid and de.uid = 'mcgzEFh5IV8' \r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid and optval.code=contactlog.value) as nextaction\r\n\ton nextaction.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select contactlog.value, _pi.programinstanceid \r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid\r\n\t\t\t\t\tand de.uid = 'HcBFZsCt8Sy' ) as nextactionduedate\r\n\ton nextactionduedate.programinstanceid=pi.programinstanceid\r\n\r\n\r\n\r\n\r\n where psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = '${stageId}' )\r\n\t and artopeningfacility.executiondate is not null\r\nORDER  BY pi.programinstanceid, psi.executiondate DESC \r\n\r\n\r\n/* \r\n where psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = 'lVglvBnE3TY' )\r\n\tand ( contactlogevent.name is not null or artclosureeventdata.programstageinstanceid is not null )\r\n\tand ( artclosureeventdata.username ='TES002' or contactlogevent.username ='TES002' )\r\nORDER  BY pi.programinstanceid, psi.executiondate DESC\r\n */\r\n\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


, {"created":"2017-06-03T03:10:13.828","lastUpdated":"2017-06-29T06:24:25.455","name":"LSDescoveryAndDesign_ARTRefer_FollowUp","id":"llbPbszABjd","sqlQuery":"select DISTINCT ON(pi.programinstanceid)\r\n tei.uid, psi.uid, psi.executiondate\r\n\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='rw3W9pDCPb2' ) as cuic\r\n\r\n, ( select optval.name from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=_tea.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='mYdfuRItatP' and optval.code=_teav.value ) as referralstatus\r\n\r\n, ( select optval.name from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=_tea.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='NLNTtpbT3c5' and optval.code=_teav.value ) as counsil\r\n\r\n, artopeningfacility.value as facility\r\n, R9Lw1uNtRuj.value as lastaction\r\n, R9Lw1uNtRuj.executiondate as lastactiondate\r\n, nextaction.value as nextaction\r\n, nextactionduedate.value as nextactiondate\r\n, extract(day from (\r\n    date 'now()' - artopeningfacility.executiondate \r\n) )  as daySinceDiagnosis\r\n, artclosureeventdata.programstageinstanceid as \tartclosureeventid\r\n, artclosureeventdata.username as artclosureusername\r\n, R9Lw1uNtRuj.username as contactlogeventusername\r\n\r\nfrom programstageinstance psi\r\ninner join organisationunit org on org.organisationunitid=psi.organisationunitid\r\ninner join programinstance pi on pi.programinstanceid=psi.programinstanceid\r\ninner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid\r\n\r\nleft outer join ( select optval.name as value, _pi.programinstanceid, _psi.executiondate\r\n\t\tfrom trackedentitydatavalue as artopeningevent\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=artopeningevent.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=artopeningevent.dataelementid and de.uid = 'E1KAxdya3y5' \r\n\t\t\t\tINNER JOIN optionset optset on optset.optionsetid=de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid and optval.code=artopeningevent.value ) as artopeningfacility\r\n\ton artopeningfacility.programinstanceid=pi.programinstanceid\r\n\r\n\r\n\r\nleft outer join ( select _pi.programinstanceid, _psi.programstageinstanceid, _psi.executiondate, catOption.code as username\r\n\t\tfrom programstageinstance _psi\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='usEIFQODMxf'\r\n\t\t\t\tinner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=_psi.attributeoptioncomboid\r\n\t\t\t\tinner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\n\t\t\t\tinner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid \r\n\t\t) as artclosureeventdata\r\n\ton artclosureeventdata.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select contactlog.value, _pi.programinstanceid, _psi.executiondate, catOption.code as username\r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid\r\n\t\t\t\tinner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=_psi.attributeoptioncomboid\r\n\t\t\t\tinner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\n\t\t\t\tinner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid\r\n\t\t\t\t\tand de.uid = 'wzM3bUiPowS' ) as R9Lw1uNtRuj\r\n\ton R9Lw1uNtRuj.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select contactlog.value, _pi.programinstanceid \r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid\r\n\t\t\t\t\tand de.uid = 'mcgzEFh5IV8' ) as nextaction\r\n\ton nextaction.programinstanceid=pi.programinstanceid\r\n\r\n\r\nleft outer join ( select contactlog.value, _pi.programinstanceid \r\n\t\tfrom trackedentitydatavalue as contactlog\r\n\t\t\t\tinner join programstageinstance _psi on _psi.programstageinstanceid=contactlog.programstageinstanceid\r\n\t\t\t\tinner join programinstance _pi on _psi.programinstanceid=_pi.programinstanceid\r\n\t\t\t\tinner join dataelement de on de.dataelementid=contactlog.dataelementid\r\n\t\t\t\t\tand de.uid = 'HcBFZsCt8Sy' ) as nextactionduedate\r\n\ton nextactionduedate.programinstanceid=pi.programinstanceid\r\n\r\n\r\n where ( ( R9Lw1uNtRuj.executiondate >= '${startDate}' and R9Lw1uNtRuj.executiondate < '${endDate}' ) or ( artclosureeventdata.executiondate >= '${startDate}' and artclosureeventdata.executiondate < '${endDate}' ) )\r\n \tand psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = '${stageId}' )\r\n\tand ( R9Lw1uNtRuj.value is not null or artclosureeventdata.programstageinstanceid is not null )\r\n  and ( artclosureeventdata.username ='${username}' or R9Lw1uNtRuj.username ='${username}' )\r\nORDER  BY pi.programinstanceid, psi.executiondate DESC \r\n\r\n\r\n/* \r\n where psi.executiondate >= '2017-05-01' and psi.executiondate < '2017-06-06'\r\n \tand psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = 'lVglvBnE3TY' )\r\n\tand ( R9Lw1uNtRuj.value is not null or artclosureeventdata.programstageinstanceid is not null )\r\n--\tand ( artclosureeventdata.username ='TES002' or R9Lw1uNtRuj.username ='TES002' )\r\nORDER  BY pi.programinstanceid, psi.executiondate DESC\r\n */\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


, {"created":"2017-06-14T09:37:29.017","lastUpdated":"2017-06-29T06:17:28.469","name":"LSDescoveryAndDesign_FindFirstClientInCouple","id":"SKI1rT5vA3m","sqlQuery":"\r\nselect psi.uid, tei.uid as clientid , psi.executiondate\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='rw3W9pDCPb2' ) as cuic\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='R9Lw1uNtRuj' ) as firstname\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='TBt2a4Bq0Lx' ) as lastname\r\n, finaltesttesultdata.value as finaltest\r\n\t\t\t\t\t\r\nfrom programstageinstance psi\r\ninner join organisationunit org on org.organisationunitid=psi.organisationunitid\r\ninner join programinstance pi on pi.programinstanceid=psi.programinstanceid\r\ninner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid\r\ninner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=psi.attributeoptioncomboid\r\ninner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\ninner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid\r\ninner join programstage pgs on  pgs.programstageid=psi.programstageid\r\n\r\nleft outer join ( select couplecuicoption.value, couplecuicoption.programstageinstanceid \r\n\t\tfrom trackedentitydatavalue as couplecuicoption\r\n\t\t\t\tinner join dataelement de on de.dataelementid=couplecuicoption.dataelementid\r\n\t\t\t\t\tand de.uid = 'csHM60DUGkG' ) as coupleoption\r\n\ton coupleoption.programstageinstanceid=psi.programstageinstanceid\r\n\t\r\n\t\r\nleft outer join ( select couplecuicoption.value, couplecuicoption.programstageinstanceid \r\n\t\tfrom trackedentitydatavalue as couplecuicoption\r\n\t\t\t\tinner join dataelement de on de.dataelementid=couplecuicoption.dataelementid\r\n\t\t\t\t\tand de.uid = 'UYyCL2xz8Wz' ) as partner\r\n\ton partner.programstageinstanceid=psi.programstageinstanceid\r\n\t\t\r\nleft outer join ( select finaltestresult.value, finaltestresult.programstageinstanceid \r\n\t\tfrom trackedentitydatavalue as finaltestresult\r\n\t\t\t\tinner join dataelement de on de.dataelementid=finaltestresult.dataelementid\r\n\t\t\t\t\tand de.uid = 'UuKat0HFjWS' ) as finaltesttesultdata\r\n\ton finaltesttesultdata.programstageinstanceid=psi.programstageinstanceid\r\n\r\nwhere psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}' \r\n \tand pgs.uid = '${stageId}'\r\n\tand catOption.code='${username}'\r\n\tand org.uid='${ouId}'\r\n\tand coupleoption.value = '1'\r\nand partner.value is null\r\n\r\n\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


,{"created":"2017-03-11T10:30:05.667","lastUpdated":"2017-05-22T10:27:23.602","name":"LSDescoveryAndDesign_loadEventsbyCUIC","id":"JIcMhtleQ7x","sqlQuery":"select tei.uid as clientId\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\twhere tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='mW2l3T2zL0N' ) as firstname\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\twhere tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='mUxDHgywnn2' ) as lastname\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\twhere tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='wSp6Q7QDMsk' ) as dateOfBirth\t\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\twhere tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='u57uh7lHwF8' ) as districtOfBirth\t\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\twhere tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='vTPYC9BXPNn' ) as birthOrder\r\n, array_to_string(array( SELECT _psi.uid || '*' || _psi.executiondate FROM programstageinstance _psi \r\n\tINNER JOIN programinstance _pi on _pi.programinstanceid=_psi.programinstanceid \r\n\tWHERE _pi.trackedentityinstanceid=tei.trackedentityinstanceid ), ', ' ) as eventDateList\r\n\r\nfrom trackedentityinstance tei \r\ninner join psi_view_trackedentityattributevalue teav on tei.trackedentityinstanceid=teav.trackedentityinstanceid\r\ninner join psi_view_trackedentityattribute tea on tea.trackedentityattributeid=teav.trackedentityattributeid\r\ninner join programinstance pi on pi.trackedentityinstanceid=tei.trackedentityinstanceid\r\ninner join program prg on prg.programid=pi.programid\r\nwhere prg.uid='KDgzpKX3h2S' and tea.uid='zRA08XEYiSF' and teav.value='${cuic}'\r\norder by tei.created desc\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}



,{"created":"2017-01-25T12:25:07.103","lastUpdated":"2017-06-29T06:31:01.648","name":"LSDescoveryAndDesign_PositiveCases","id":"mayPuvHkJ7G","sqlQuery":"select -- DISTINCT ON(psi.organisationunitid, psi.programstageid)\r\n tei.uid, psi.uid, psi.executiondate, finaltesttesultdata.value\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='rw3W9pDCPb2' ) as cuic\r\n\r\n, ( select COUNT(_psi.programstageinstanceid) \r\n\t\t\tfrom programstageinstance _psi\r\n\t\t\t\t\tinner join programinstance _pi on _pi.programinstanceid=_psi.programinstanceid\r\n\t\t\t\t\tinner join programstage _prgs on _prgs.programstageid=_psi.programstageid\r\n\t\t\twhere _pi.programinstanceid=pi.programinstanceid\r\n\t\t\t\t\tand _prgs.uid='${stageId}' ) as noevent\r\n, org.name\r\n\r\n, ( select optval.name from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\t\tINNER JOIN optionset opts on opts.optionsetid=_tea.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=opts.optionsetid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='mYdfuRItatP' and _teav.value=optval.code ) as artstatus\r\n\r\n, ( select DISTINCT on ( optval.name ) optval.name from trackedentitydatavalue _tedv \r\n\t\t\t\tINNER JOIN dataelement _de on _de.dataelementid=_tedv.dataelementid\r\n\t\t\t\tinner join programstageinstance _psi on _tedv.programstageinstanceid=_psi.programstageinstanceid\r\n\t\t\t\tINNER JOIN optionset opts on opts.optionsetid=_de.optionsetid\r\n\t\t\t\tINNER JOIN optionvalue optval on optval.optionsetid=opts.optionsetid\r\n\t\twhere _psi.programinstanceid=pi.programinstanceid\r\n\t\t\t\t\tand _de.uid='E1KAxdya3y5' and _tedv.value=optval.code ) as artopeningfacility\r\n\r\n\r\n\r\nfrom programstageinstance psi\r\ninner join organisationunit org on org.organisationunitid=psi.organisationunitid\r\ninner join programinstance pi on pi.programinstanceid=psi.programinstanceid\r\ninner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid\r\ninner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=psi.attributeoptioncomboid\r\ninner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\ninner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid\r\n\r\n\r\nleft outer join ( select finaltestresult.value, finaltestresult.programstageinstanceid \r\n\t\tfrom trackedentitydatavalue as finaltestresult\r\n\t\t\t\tinner join dataelement de on de.dataelementid=finaltestresult.dataelementid\r\n\t\t\t\t\tand de.uid = 'UuKat0HFjWS' ) as finaltesttesultdata\r\n\ton finaltesttesultdata.programstageinstanceid=psi.programstageinstanceid\r\n\r\n\r\n\r\n/* \r\nwhere psi.executiondate >= '2017-01-01' and psi.executiondate < '2017-07-01'\r\n \tand psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = 'lVglvBnE3TY' )\r\n\tand catOption.code='TES001'\r\n*/\r\n\r\n where psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}'\r\n \tand psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = '${stageId}' )\r\n\tand catOption.code='${username}'\r\n\r\n\r\n\r\n\tand psi.programstageinstanceid in (\r\n\t\tselect _tedv.programstageinstanceid from trackedentitydatavalue _tedv \r\n\t\t\t\tINNER JOIN dataelement _de on _de.dataelementid=_tedv.dataelementid\r\n\t\t\t\t\tand _de.uid='UuKat0HFjWS' and _tedv.value='Positive'\r\n\t)\r\n\r\nORDER  BY psi.organisationunitid, psi.programstageid, psi.executiondate DESC\r\n\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


,{"created":"2017-03-24T04:11:29.338","lastUpdated":"2017-06-29T07:10:44.099","name":"LSDescoveryAndDesign_searchClients","id":"zPJW0n6mymH","sqlQuery":"select tei_client.uid\r\n\r\n, ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END ) as firstname\r\n, ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) as lastname\r\n, ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) as birthdate\r\n, ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) as birthdistrict\r\n, ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) as birthorder\r\n, pi_client.enrollmentdate\r\n, max( latest_event.executiondate ) as latestevent\r\n\r\nfrom trackedentityinstance as tei_client\r\n\r\ninner join programinstance as pi_client\r\n\ton tei_client.trackedentityinstanceid = pi_client.trackedentityinstanceid\r\n\r\nleft outer join programstageinstance as latest_event\r\n\ton pi_client.programinstanceid = latest_event.programinstanceid\r\n\r\ninner join program as prg \r\n\ton prg.programid = pi_client.programid\r\n\r\n-- firstname\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='R9Lw1uNtRuj' ) as \"R9Lw1uNtRuj\"\r\n\ton \"R9Lw1uNtRuj\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- lastname\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='TBt2a4Bq0Lx' ) as \"TBt2a4Bq0Lx\" \r\n\ton \"TBt2a4Bq0Lx\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- birthdate\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='BvsJfkddTgZ' ) as \"BvsJfkddTgZ\" \r\n\ton \"BvsJfkddTgZ\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- district\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='u57uh7lHwF8' ) as \"u57uh7lHwF8\" \r\n\ton \"u57uh7lHwF8\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- birth order\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='vTPYC9BXPNn' ) as \"vTPYC9BXPNn\" -- district\r\n\ton \"vTPYC9BXPNn\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\nwhere prg.uid='KDgzpKX3h2S' \r\n\r\nand  ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END ) ilike '%${R9Lw1uNtRuj}%'\r\nand  ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) ilike '%${TBt2a4Bq0Lx}%'\r\nand  ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) ilike '%${BvsJfkddTgZ}%' \r\nand  ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) ilike '%${u57uh7lHwF8}%'\r\nand  ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) ilike '%${vTPYC9BXPNn}%'\r\n\r\ngroup by tei_client.uid, \"R9Lw1uNtRuj\".value, \"TBt2a4Bq0Lx\".value\r\n, \"BvsJfkddTgZ\".value, \"u57uh7lHwF8\".value\r\n, \"vTPYC9BXPNn\".value, pi_client.enrollmentdate, tei_client.created\r\n\r\nORDER BY tei_client.created\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


,{"created":"2017-06-19T06:15:44.896","lastUpdated":"2017-06-29T07:02:04.759","name":"LSDescoveryAndDesign_SearchPositiveClient","id":"aUc8BV6Ipmu","sqlQuery":"select tei_client.uid\r\n\r\n, ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END ) as firstname\r\n, ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) as lastname\r\n, ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) as birthdate\r\n, ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) as birthdistrict\r\n, ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) as birthorder\r\n, pi_client.enrollmentdate\r\n, max( event.executiondate ) as event\r\n\r\nfrom trackedentityinstance as tei_client\r\n\r\ninner join programinstance as pi_client\r\n\ton tei_client.trackedentityinstanceid = pi_client.trackedentityinstanceid\r\n\r\nleft outer join programstageinstance as event\r\n\ton pi_client.programinstanceid = event.programinstanceid\r\n\r\ninner join program as prg \r\n\ton prg.programid = pi_client.programid\r\n\r\n-- firstname\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='R9Lw1uNtRuj' ) as \"R9Lw1uNtRuj\"\r\n\ton \"R9Lw1uNtRuj\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- lastname\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='TBt2a4Bq0Lx' ) as \"TBt2a4Bq0Lx\" \r\n\ton \"TBt2a4Bq0Lx\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- birthdate\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='BvsJfkddTgZ' ) as \"BvsJfkddTgZ\" \r\n\ton \"BvsJfkddTgZ\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- district\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='u57uh7lHwF8' ) as \"u57uh7lHwF8\" \r\n\ton \"u57uh7lHwF8\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n-- birth order\r\nleft outer join ( select _teav.trackedentityinstanceid, _teav.value\r\n\t\tfrom psi_view_trackedentityattributevalue _teav\r\n\t\t\tinner join psi_view_trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r\n\t\twhere _tea.uid='vTPYC9BXPNn' ) as \"vTPYC9BXPNn\" -- district\r\n\ton \"vTPYC9BXPNn\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r\n\r\n\r\nwhere prg.uid='KDgzpKX3h2S' \r\n\r\ngroup by tei_client.uid, \"R9Lw1uNtRuj\".value, \"TBt2a4Bq0Lx\".value\r\n, \"BvsJfkddTgZ\".value, \"u57uh7lHwF8\".value\r\n, \"vTPYC9BXPNn\".value, pi_client.enrollmentdate, tei_client.created\r\n\r\nORDER BY tei_client.created\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}


,{"created":"2017-01-25T10:25:56.391","lastUpdated":"2017-06-29T06:25:51.125","name":"LSDescoveryAndDesign_loadCases","id":"IdFgIYoRINL","sqlQuery":"select DISTINCT ON(pi.programinstanceid)\r\n tei.uid, psi.uid, psi.executiondate, finaltesttesultdata.value\r\n, ( select value from psi_view_trackedentityattributevalue _teav\r\n\t\t\t\tINNER JOIN psi_view_trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r\n\t\t\t\tINNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r\n\t\t\twhere pi.trackedentityinstanceid=_tei.trackedentityinstanceid\r\n\t\t\t\t\tand _tea.uid='rw3W9pDCPb2' ) as cuic\r\n\r\n, ( select COUNT(_psi.programstageinstanceid) \r\n\t\t\tfrom programstageinstance _psi\r\n\t\t\t\t\tinner join programinstance _pi on _pi.programinstanceid=_psi.programinstanceid\r\n\t\t\t\t\tinner join programstage _prgs on _prgs.programstageid=_psi.programstageid\r\n\t\t\twhere _pi.programinstanceid=pi.programinstanceid\r\n\t\t\t\t\tand _prgs.uid='${stageId}' ) as noevent\r\n, org.name\r\n\r\nfrom programstageinstance psi\r\ninner join organisationunit org on org.organisationunitid=psi.organisationunitid\r\ninner join programinstance pi on pi.programinstanceid=psi.programinstanceid\r\ninner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid\r\ninner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=psi.attributeoptioncomboid\r\ninner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid\r\ninner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid\r\n\r\n\r\nleft outer join ( select finaltestresult.value, finaltestresult.programstageinstanceid \r\n\t\tfrom trackedentitydatavalue as finaltestresult\r\n\t\t\t\tinner join dataelement de on de.dataelementid=finaltestresult.dataelementid\r\n\t\t\t\t\tand de.uid = 'UuKat0HFjWS' ) as finaltesttesultdata\r\n\ton finaltesttesultdata.programstageinstanceid=psi.programstageinstanceid\r\n\r\n\r\n where psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}'\r\n \tand psi.programstageid in ( select _ps.programstageid \r\n\t\t\t\tfrom programstage _ps where _ps.uid = '${stageId}' )\r\n\tand catOption.code='${username}'\r\n\r\nORDER  BY pi.programinstanceid, psi.executiondate DESC\r\n\r\n\r\n\r\n\r\n\r\n","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","user":{"id":"EXc0WvNU0Hu"},"userGroupAccesses":[],"attributeValues":[]}

]}