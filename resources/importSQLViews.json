{"system":{"id":"d1a6eab7-ddc3-4dd1-a17d-caf61735f991","rev":"d29d0c7","version":"2.33.3","date":"2020-05-11T04:59:56.940"},"sqlViews":[{"created":"2017-06-22T05:22:22.500","lastUpdated":"2020-05-06T08:24:04.888","name":"LSDescoveryAndDesign_ARTRefer_AllFollowUp","href":"https://new.psi-mis.org/api/sqlViews/I8xOsd6qfyh","id":"I8xOsd6qfyh","sqlQuery":"  select tei.uid    , cuic.value    , ''    , ''    , extract(day from (      date 'now()' - openartevent.executiondate   ) ) as daySinceDiagnosis     , counsil.value    , openartevent.uid  , openartevent.executiondate    , facilityevent.facility  , facilityevent.facility_other      , contactevent.executiondate as lasteventdate  , contactevent.tedv_lastactionname  , contactevent.tedv_nextactionduedate  , contactevent.tedv_nextactionname    , contacteventwithusername.count    , _openartevent_username.username    , closearteventwithusername.executiondate  , closearteventwithusername.username  , closearteventwithusername.value      from trackedentityinstance tei  inner join programinstance pi         on pi.trackedentityinstanceid=tei.trackedentityinstanceid  inner join programstageinstance openartevent        on openartevent.programinstanceid=pi.programinstanceid  inner join programstage stage             on stage.uid='OSpZnLBMVhr'            and stage.programid=pi.programid and openartevent.programstageid=stage.programstageid    -- ===================================    left outer join ( select _teav.value, _teav.trackedentityinstanceid  from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid        where _tea.uid='rw3W9pDCPb2' ) as cuic on tei.trackedentityinstanceid=cuic.trackedentityinstanceid     left outer join ( select _teav.value, _teav.trackedentityinstanceid  from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid        where _tea.uid='NLNTtpbT3c5' ) as counsil on tei.trackedentityinstanceid=counsil.trackedentityinstanceid           ----------------------- Opening user created -----------------------    left outer join ( select catOption.code as username, _openartevent.programstageinstanceid      from programstageinstance _openartevent       inner join programstage _stage         on _stage.programstageid = _openartevent.programstageid and _stage.uid='gmBozy0KAMC'       inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=_openartevent.attributeoptioncomboid      inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid      inner join dataelementcategoryoption catOption         on catOption.categoryoptionid=catoptrls.categoryoptionid       where catOption.code = '${username}'       group by catOption.code, _openartevent.programstageinstanceid    ) as _openartevent_username     on _openartevent_username.programstageinstanceid = openartevent.programstageinstanceid     ----------------------- latest contact log event -----------------------    left outer join    ( select eventlatest.programinstanceid, eventlatest.programstageinstanceid, eventlatest.executiondate    ,eventlatest.eventdatavalues -> 'hjpNXAyZ0cm' ->> 'value' as tedv_lastactionname    ,eventlatest.eventdatavalues -> 'HcBFZsCt8Sy' ->> 'value' as tedv_nextactionduedate    ,eventlatest.eventdatavalues -> 'mcgzEFh5IV8' ->> 'value' as tedv_nextactionname     from programstageinstance as eventlatest      inner join programstage _stage on _stage.programstageid = eventlatest.programstageid and _stage.uid='gmBozy0KAMC'      order by eventlatest.executiondate desc       limit 1   ) as contactevent -- contactevent_latest   on pi.programinstanceid = contactevent.programinstanceid    ----------------------- Check Contact log event with username -----------------------    left outer join ( select count( contactlogevent.executiondate ) as count, contactlogevent.programinstanceid      from programstageinstance contactlogevent       inner join programstage _stage         on _stage.programstageid = contactlogevent.programstageid and _stage.uid='gmBozy0KAMC'       inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=contactlogevent.attributeoptioncomboid      inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid      inner join dataelementcategoryoption catOption         on catOption.categoryoptionid=catoptrls.categoryoptionid       where catOption.code =  '${username}'      group by contactlogevent.programinstanceid    ) as contacteventwithusername     on pi.programinstanceid = contacteventwithusername.programinstanceid     left outer join ( select catOption.code as username      , closeartevent.eventdatavalues  -> 'nOK8JcDWT9X' ->> 'value' as value      , closeartevent.programinstanceid, closeartevent.executiondate      from programstageinstance closeartevent      inner join programstage _stage         on _stage.programstageid = closeartevent.programstageid and _stage.uid='usEIFQODMxf'       inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=closeartevent.attributeoptioncomboid       inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid       inner join dataelementcategoryoption catOption         on catOption.categoryoptionid=catoptrls.categoryoptionid     ) as closearteventwithusername     on pi.programinstanceid = closearteventwithusername.programinstanceid     ------------------------- Facility in Opening event -------------------------    -- Facility    left outer join ( select _psi.eventdatavalues  -> 'E1KAxdya3y5' ->> 'value' as facility    , _psi.eventdatavalues  -> 'CLclHLxzl9e' ->> 'value' as facility_other    , _psi.programinstanceid      from programstageinstance _psi        inner join programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='OSpZnLBMVhr'    ) as facilityevent on pi.programinstanceid = facilityevent.programinstanceid      -- ===================================    group by tei.uid, tei.trackedentityinstanceid, openartevent.executiondate, cuic.value, counsil.value  ,contactevent.executiondate,contactevent.tedv_lastactionname,contactevent.tedv_nextactionduedate, contactevent.tedv_nextactionname  ,contacteventwithusername.count, closearteventwithusername.username  , facilityevent.facility  ,openartevent.uid  ,_openartevent_username.username  ,closearteventwithusername.executiondate  ,closearteventwithusername.value  , facilityevent.facility_other  ","displayName":"LSDescoveryAndDesign_ARTRefer_AllFollowUp","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-06-03T03:10:13.828","lastUpdated":"2020-05-04T08:56:12.307","name":"LSDescoveryAndDesign_ARTRefer_FollowUp","href":"https://new.psi-mis.org/api/sqlViews/llbPbszABjd","id":"llbPbszABjd","sqlQuery":"select DISTINCT ON(pi.programinstanceid)   tei.uid, psi.uid, psi.executiondate    , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='rw3W9pDCPb2' ) as cuic    , ( select optval.name from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid          INNER JOIN optionset optset on optset.optionsetid=_tea.optionsetid          INNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='mYdfuRItatP' and optval.code=_teav.value ) as referralstatus    , ( select optval.name from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid          INNER JOIN optionset optset on optset.optionsetid=_tea.optionsetid          INNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='NLNTtpbT3c5' and optval.code=_teav.value ) as counsil        , artopeningfacility.value as facility  , contactlogEvent.eventdatavalues  -> 'wzM3bUiPowS' ->> 'value' as lastaction   , contactlogEvent.executiondate as lastactiondate  , contactlogEvent.eventdatavalues  -> 'mcgzEFh5IV8' ->> 'value' as nextaction  , contactlogEvent.eventdatavalues  -> 'HcBFZsCt8Sy' ->> 'value' as nextactiondate  , extract(day from (      date 'now()' - artopeningfacility.executiondate   ) )  as daySinceDiagnosis  , artclosureeventdata.programstageinstanceid as   artclosureeventid  , artclosureeventdata.username as artclosureusername  , contactlogEvent.username as contactlogeventusername    from programstageinstance psi  inner join organisationunit org on org.organisationunitid=psi.organisationunitid  inner join programinstance pi on pi.programinstanceid=psi.programinstanceid  inner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid    left outer join ( select optval.name as value, _pi.programinstanceid, artopeningevent.executiondate      from programstageinstance artopeningevent          inner join programinstance _pi on artopeningevent.programinstanceid=_pi.programinstanceid          inner join programstage _pgs on _pgs.programstageid=artopeningevent.programstageid and _pgs.uid='OSpZnLBMVhr'          inner join dataelement de on de.uid = 'E1KAxdya3y5'           INNER JOIN optionset optset on optset.optionsetid=de.optionsetid          INNER JOIN optionvalue optval on optval.optionsetid=optset.optionsetid           and artopeningevent.eventdatavalues  -> 'E1KAxdya3y5' ->> 'value' > optval.code ) as artopeningfacility    on artopeningfacility.programinstanceid=pi.programinstanceid    left outer join ( select _pi.programinstanceid, artclosureevent.programstageinstanceid, artclosureevent.executiondate, catOption.code as username      from programstageinstance artclosureevent          inner join programinstance _pi on artclosureevent.programinstanceid=_pi.programinstanceid          inner join programstage _pgs on _pgs.programstageid=artclosureevent.programstageid and _pgs.uid='usEIFQODMxf'          inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=artclosureevent.attributeoptioncomboid          inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid          inner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid       ) as artclosureeventdata    on artclosureeventdata.programinstanceid=pi.programinstanceid      left outer join ( select contactlog.eventdatavalues, _pi.programinstanceid, contactlog.executiondate, catOption.code as username      from programstageinstance contactlog          inner join programinstance _pi on contactlog.programinstanceid=_pi.programinstanceid          inner join dataelement de on de.uid = 'wzM3bUiPowS'          inner join programstage _pgs on _pgs.programstageid=contactlog.programstageid and _pgs.uid='gmBozy0KAMC'          inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=contactlog.attributeoptioncomboid          inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid          inner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid           ) as contactlogEvent    on contactlogEvent.programinstanceid=pi.programinstanceid         where ( ( contactlogEvent.executiondate >= '${startDate}' and contactlogEvent.executiondate < '${endDate}' ) or ( artclosureeventdata.executiondate >= '${startDate}' and artclosureeventdata.executiondate < '${endDate}' ) )     and psi.programstageid in ( select _ps.programstageid           from programstage _ps where _ps.uid = '${stageId}' )    and ( contactlogEvent.eventdatavalues  -> 'wzM3bUiPowS' ->> 'value' is not null or artclosureeventdata.programstageinstanceid is not null )    and ( artclosureeventdata.username ='${username}' or contactlogEvent.username ='${username}' )  ORDER  BY pi.programinstanceid, psi.executiondate DESC   ","displayName":"LSDescoveryAndDesign_ARTRefer_FollowUp","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-06-14T09:37:29.017","lastUpdated":"2020-05-04T06:04:40.120","name":"LSDescoveryAndDesign_FindFirstClientInCouple","href":"https://new.psi-mis.org/api/sqlViews/SKI1rT5vA3m","id":"SKI1rT5vA3m","sqlQuery":"  select psi.uid, tei.uid as clientid , psi.executiondate  , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='rw3W9pDCPb2' ) as cuic  , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='R9Lw1uNtRuj' ) as firstname  , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='TBt2a4Bq0Lx' ) as lastname  , psi.eventdatavalues  -> 'UuKat0HFjWS' ->> 'value' > '1' as finaltest              from programstageinstance psi  inner join organisationunit org on org.organisationunitid=psi.organisationunitid  inner join programinstance pi on pi.programinstanceid=psi.programinstanceid  inner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid  inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=psi.attributeoptioncomboid  inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid  inner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid  inner join programstage pgs on  pgs.programstageid=psi.programstageid    where  psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}'      and pgs.uid = '${stageId}'    and catOption.code='${username}'    and org.uid='${ouId}'    and psi.eventdatavalues  -> 'csHM60DUGkG' ->> 'value' > '1'    and psi.eventdatavalues  -> 'UYyCL2xz8Wz' ->> 'value' is null","displayName":"LSDescoveryAndDesign_FindFirstClientInCouple","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-01-25T10:25:56.391","lastUpdated":"2020-04-29T05:23:00.870","name":"LSDescoveryAndDesign_loadCases","href":"https://new.psi-mis.org/api/sqlViews/IdFgIYoRINL","id":"IdFgIYoRINL","sqlQuery":"select DISTINCT ON(pi.programinstanceid)   tei_client.uid as clientuid, psi.uid as eventuid, psi.executiondate  -- , finaltesttesultdata.value  ,  psi.eventdatavalues  -> 'UuKat0HFjWS' ->> 'value'  finaltesttesultdata_Value  , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where tei_client.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='rw3W9pDCPb2' ) as cuic    , ( select COUNT(_psi.programstageinstanceid)         from programstageinstance _psi            inner join programinstance _pi on _pi.programinstanceid=_psi.programinstanceid            inner join programstage _prgs on _prgs.programstageid=_psi.programstageid        where _pi.programinstanceid=pi.programinstanceid            and _prgs.uid='${stageId}' ) as noevent  , org.name    , psi.status    , ( select count(*)        from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid            and _tea.uid in ( 'ZQiKIaeOKv4', 'Rl2hRelrfur', 'qynN2cqRe71', 'NLNTtpbT3c5', 'VRUFmF5tE7b' )        where tei_client.trackedentityinstanceid=_teav.trackedentityinstanceid ) as contactlog_info    -- Heath Facility in [ART Opening] event  , artopening_event.programstageinstanceid    -- , artchecked.value  , psi.eventdatavalues  -> 'tUIkmIFMEDS' ->> 'value'  as artchecked_Value    -- Heath Facility in [PrEP Refer Opening] event  , prepreferopening_event.programstageinstanceid      from programstageinstance psi  inner join organisationunit org on org.organisationunitid=psi.organisationunitid  inner join programinstance pi on pi.programinstanceid=psi.programinstanceid  inner join trackedentityinstance tei_client on tei_client.trackedentityinstanceid=pi.trackedentityinstanceid  inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=psi.attributeoptioncomboid  inner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid   inner join program as prg on prg.programid = pi.programid      --left outer join ( select finaltestresult.value, finaltestresult.programstageinstanceid   --    from trackedentitydatavalue as finaltestresult  --        inner join dataelement de on de.dataelementid=finaltestresult.dataelementid  --          and de.uid = 'UuKat0HFjWS' ) as finaltesttesultdata  --  on finaltesttesultdata.programstageinstanceid=psi.programstageinstanceid    --left outer join ( select finaltestresult.value, finaltestresult.programstageinstanceid   --    from trackedentitydatavalue as finaltestresult  --        inner join dataelement de on de.dataelementid=finaltestresult.dataelementid  --          and de.uid = 'tUIkmIFMEDS' ) as artchecked  --  on artchecked.programstageinstanceid=psi.programstageinstanceid      left outer join ( select _psi.programinstanceid, _psi.programstageinstanceid      from programstageinstance _psi          inner join programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='OSpZnLBMVhr'   ) as artopening_event on  artopening_event.programinstanceid=pi.programinstanceid      left outer join ( select _psi.programinstanceid, _psi.programstageinstanceid      from programstageinstance _psi          inner join programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='R5UixJ6WEAn'   ) as prepreferopening_event on  prepreferopening_event.programinstanceid=pi.programinstanceid       where psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}'     and psi.programstageid in ( select _ps.programstageid           from programstage _ps where _ps.uid = '${stageId}' )    and catOption.code='${username}'        ORDER  BY pi.programinstanceid, psi.executiondate DESC  ","displayName":"LSDescoveryAndDesign_loadCases","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-03-11T10:30:05.667","lastUpdated":"2017-06-29T09:10:32.719","name":"LSDescoveryAndDesign_loadEventsbyCUIC","href":"https://new.psi-mis.org/api/sqlViews/JIcMhtleQ7x","id":"JIcMhtleQ7x","sqlQuery":"select tei.uid as clientId\r  , ( select value from trackedentityattributevalue _teav\r          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r        where tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r            and _tea.uid='mW2l3T2zL0N' ) as firstname\r  , ( select value from trackedentityattributevalue _teav\r          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r        where tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r            and _tea.uid='mUxDHgywnn2' ) as lastname\r  , ( select value from trackedentityattributevalue _teav\r          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r        where tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r            and _tea.uid='wSp6Q7QDMsk' ) as dateOfBirth  \r  , ( select value from trackedentityattributevalue _teav\r          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r        where tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r            and _tea.uid='u57uh7lHwF8' ) as districtOfBirth  \r  , ( select value from trackedentityattributevalue _teav\r          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid\r        where tei.trackedentityinstanceid=_teav.trackedentityinstanceid\r            and _tea.uid='vTPYC9BXPNn' ) as birthOrder\r  , array_to_string(array( SELECT _psi.uid || '*' || _psi.executiondate FROM programstageinstance _psi \r    INNER JOIN programinstance _pi on _pi.programinstanceid=_psi.programinstanceid \r    WHERE _pi.trackedentityinstanceid=tei.trackedentityinstanceid ), ', ' ) as eventDateList\r  \r  from trackedentityinstance tei \r  inner join trackedentityattributevalue teav on tei.trackedentityinstanceid=teav.trackedentityinstanceid\r  inner join trackedentityattribute tea on tea.trackedentityattributeid=teav.trackedentityattributeid\r  inner join programinstance pi on pi.trackedentityinstanceid=tei.trackedentityinstanceid\r  inner join program prg on prg.programid=pi.programid\r  where prg.uid='KDgzpKX3h2S' and tea.uid='zRA08XEYiSF' and teav.value='${cuic}'\r  order by tei.created desc\r  ","displayName":"LSDescoveryAndDesign_loadEventsbyCUIC","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-01-25T12:25:07.103","lastUpdated":"2020-05-04T05:26:10.901","name":"LSDescoveryAndDesign_PositiveCases","href":"https://new.psi-mis.org/api/sqlViews/mayPuvHkJ7G","id":"mayPuvHkJ7G","sqlQuery":"select -- DISTINCT ON(psi.organisationunitid, psi.programstageid)   tei.uid as clientuid, psi.uid as eventtuid, psi.executiondate   , psi.eventdatavalues  -> 'UuKat0HFjWS' ->> 'value'  as finaltesttesultdata_Value  , ( select value from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='rw3W9pDCPb2' ) as cuic    , ( select COUNT(_psi.programstageinstanceid)         from programstageinstance _psi            inner join programinstance _pi on _pi.programinstanceid=_psi.programinstanceid            inner join programstage _prgs on _prgs.programstageid=_psi.programstageid        where _pi.programinstanceid=pi.programinstanceid            and _prgs.uid='${stageId}' ) as noevent  , org.name    , ( select optval.name from trackedentityattributevalue _teav          INNER JOIN trackedentityattribute _tea on _tea.trackedentityattributeid=_teav.trackedentityattributeid          INNER JOIN trackedentityinstance _tei on _tei.trackedentityinstanceid=_teav.trackedentityinstanceid          INNER JOIN optionset opts on opts.optionsetid=_tea.optionsetid          INNER JOIN optionvalue optval on optval.optionsetid=opts.optionsetid        where pi.trackedentityinstanceid=_tei.trackedentityinstanceid            and _tea.uid='mYdfuRItatP' and _teav.value=optval.code ) as artstatus            , ( select _psi.eventdatavalues -> 'UuKat0HFjWS' -> 'value'      from programstageinstance _psi          INNER JOIN programstage _pgs on _pgs.programstageid=_psi.programstageid and _pgs.uid='OSpZnLBMVhr'          INNER JOIN dataelement _de on _de.uid='UuKat0HFjWS'          INNER JOIN optionset opts on opts.optionsetid=_de.optionsetid          INNER JOIN optionvalue optval on optval.optionsetid=opts.optionsetid      where _psi.programinstanceid=pi.programinstanceid            and _psi.eventdatavalues  -> 'UuKat0HFjWS' -> 'value' is not null             and _psi.eventdatavalues -> 'UuKat0HFjWS' ->> 'value' > optval.code ) as artopeningfacility        from programstageinstance psi  inner join organisationunit org on org.organisationunitid=psi.organisationunitid  inner join programinstance pi on pi.programinstanceid=psi.programinstanceid  inner join trackedentityinstance tei on tei.trackedentityinstanceid=pi.trackedentityinstanceid  inner join categoryoptioncombo catoptcom on catoptcom.categoryoptioncomboid=psi.attributeoptioncomboid  inner join categoryoptioncombos_categoryoptions catoptrls on catoptrls.categoryoptioncomboid=catoptcom.categoryoptioncomboid  inner join dataelementcategoryoption catOption on catOption.categoryoptionid=catoptrls.categoryoptionid     where psi.executiondate >= '${startDate}' and psi.executiondate < '${endDate}'     and psi.programstageid in ( select _ps.programstageid           from programstage _ps where _ps.uid = '${stageId}' )    and catOption.code='${username}'    and psi.eventdatavalues  -> 'UuKat0HFjWS' -> 'value' > '\"\\\"Positive\\\"\"'    ORDER  BY psi.organisationunitid, psi.programstageid, psi.executiondate DESC    ","displayName":"LSDescoveryAndDesign_PositiveCases","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-03-24T04:11:29.338","lastUpdated":"2017-08-09T18:56:18.241","name":"LSDescoveryAndDesign_searchClients","href":"https://new.psi-mis.org/api/sqlViews/zPJW0n6mymH","id":"zPJW0n6mymH","sqlQuery":"\r  select tei_client.uid\r  \r  , ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END ) as firstname\r  , ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) as lastname\r  , ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) as birthdate\r  , ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) as birthdistrict\r  , ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) as birthorder\r  , pi_client.enrollmentdate\r  , max( latest_event.executiondate ) as latestevent\r  \r  from trackedentityinstance as tei_client\r  \r  inner join programinstance as pi_client\r    on tei_client.trackedentityinstanceid = pi_client.trackedentityinstanceid\r  \r  left outer join programstageinstance as latest_event\r    on pi_client.programinstanceid = latest_event.programinstanceid\r  \r  inner join program as prg \r    on prg.programid = pi_client.programid\r  \r  -- firstname\r  left outer join ( select _teav.trackedentityinstanceid, _teav.value\r      from trackedentityattributevalue _teav\r        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r      where _tea.uid='R9Lw1uNtRuj' ) as \"R9Lw1uNtRuj\"\r    on \"R9Lw1uNtRuj\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r  \r  -- lastname\r  left outer join ( select _teav.trackedentityinstanceid, _teav.value\r      from trackedentityattributevalue _teav\r        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r      where _tea.uid='TBt2a4Bq0Lx' ) as \"TBt2a4Bq0Lx\" \r    on \"TBt2a4Bq0Lx\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r  \r  -- birthdate\r  left outer join ( select _teav.trackedentityinstanceid, _teav.value\r      from trackedentityattributevalue _teav\r        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r      where _tea.uid='BvsJfkddTgZ' ) as \"BvsJfkddTgZ\" \r    on \"BvsJfkddTgZ\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r  \r  -- district\r  left outer join ( select _teav.trackedentityinstanceid, _teav.value\r      from trackedentityattributevalue _teav\r        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r      where _tea.uid='u57uh7lHwF8' ) as \"u57uh7lHwF8\" \r    on \"u57uh7lHwF8\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r  \r  -- birth order\r  left outer join ( select _teav.trackedentityinstanceid, _teav.value\r      from trackedentityattributevalue _teav\r        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid\r      where _tea.uid='vTPYC9BXPNn' ) as \"vTPYC9BXPNn\" -- district\r    on \"vTPYC9BXPNn\".trackedentityinstanceid = tei_client.trackedentityinstanceid\r  \r  where prg.uid='KDgzpKX3h2S' \r  \r  and  replace( ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END )  , '''', '-')   \r      ilike '%${R9Lw1uNtRuj}%'\r  and  replace( ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) , '''', '-') \r      ilike '%${TBt2a4Bq0Lx}%'    \r  and  replace( ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) , '''', '-') \r      ilike '%${BvsJfkddTgZ}%'\r  and  replace( ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) , '''', '-') \r      ilike '%${u57uh7lHwF8}%'    \r  and  replace( ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) , '''', '-') \r      ilike '%${vTPYC9BXPNn}%'    \r  \r  group by tei_client.uid, \"R9Lw1uNtRuj\".value, \"TBt2a4Bq0Lx\".value\r  , \"BvsJfkddTgZ\".value, \"u57uh7lHwF8\".value\r  , \"vTPYC9BXPNn\".value, pi_client.enrollmentdate, tei_client.created\r  \r  ORDER BY tei_client.created\r  ","displayName":"LSDescoveryAndDesign_searchClients","publicAccess":"rw------","description":"","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]},{"created":"2017-06-19T06:15:44.896","lastUpdated":"2020-05-04T05:37:42.944","name":"LSDescoveryAndDesign_SearchPositiveClient","href":"https://new.psi-mis.org/api/sqlViews/aUc8BV6Ipmu","id":"aUc8BV6Ipmu","sqlQuery":"  select tei_client.uid    , ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END ) as firstname  , ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) as lastname  , ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) as birthdate  , ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) as birthdistrict  , ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) as birthorder  , pi_client.enrollmentdate  , max( event.executiondate ) as event    from trackedentityinstance as tei_client    inner join programinstance as pi_client    on tei_client.trackedentityinstanceid = pi_client.trackedentityinstanceid    left outer join programstageinstance as event    on pi_client.programinstanceid = event.programinstanceid    inner join program as prg     on prg.programid = pi_client.programid    -- firstname  left outer join ( select _teav.trackedentityinstanceid, _teav.value      from trackedentityattributevalue _teav        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid      where _tea.uid='R9Lw1uNtRuj' ) as \"R9Lw1uNtRuj\"    on \"R9Lw1uNtRuj\".trackedentityinstanceid = tei_client.trackedentityinstanceid    -- lastname  left outer join ( select _teav.trackedentityinstanceid, _teav.value      from trackedentityattributevalue _teav        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid      where _tea.uid='TBt2a4Bq0Lx' ) as \"TBt2a4Bq0Lx\"     on \"TBt2a4Bq0Lx\".trackedentityinstanceid = tei_client.trackedentityinstanceid    -- birthdate  left outer join ( select _teav.trackedentityinstanceid, _teav.value      from trackedentityattributevalue _teav        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid      where _tea.uid='BvsJfkddTgZ' ) as \"BvsJfkddTgZ\"     on \"BvsJfkddTgZ\".trackedentityinstanceid = tei_client.trackedentityinstanceid    -- district  left outer join ( select _teav.trackedentityinstanceid, _teav.value      from trackedentityattributevalue _teav        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid      where _tea.uid='u57uh7lHwF8' ) as \"u57uh7lHwF8\"     on \"u57uh7lHwF8\".trackedentityinstanceid = tei_client.trackedentityinstanceid    -- birth order  left outer join ( select _teav.trackedentityinstanceid, _teav.value      from trackedentityattributevalue _teav        inner join trackedentityattribute _tea on _teav.trackedentityattributeid=_tea.trackedentityattributeid      where _tea.uid='vTPYC9BXPNn' ) as \"vTPYC9BXPNn\" -- district    on \"vTPYC9BXPNn\".trackedentityinstanceid = tei_client.trackedentityinstanceid      where prg.uid='KDgzpKX3h2S'     and  replace( ( CASE WHEN ( \"R9Lw1uNtRuj\".value is null ) THEN ' ' ELSE ' ' || \"R9Lw1uNtRuj\".value END )  , '''', '-')         ilike '%${R9Lw1uNtRuj}%'  and  replace( ( CASE WHEN ( \"TBt2a4Bq0Lx\".value is null ) THEN ' ' ELSE ' ' || \"TBt2a4Bq0Lx\".value END ) , '''', '-')       ilike '%${TBt2a4Bq0Lx}%'      and  replace( ( CASE WHEN ( \"BvsJfkddTgZ\".value is null ) THEN ' ' ELSE ' ' || \"BvsJfkddTgZ\".value END ) , '''', '-')       ilike '%${BvsJfkddTgZ}%'  and  replace( ( CASE WHEN ( \"u57uh7lHwF8\".value is null ) THEN ' ' ELSE ' ' || \"u57uh7lHwF8\".value END ) , '''', '-')       ilike '%${u57uh7lHwF8}%'      and  replace( ( CASE WHEN ( \"vTPYC9BXPNn\".value is null ) THEN ' ' ELSE ' ' || \"vTPYC9BXPNn\".value END ) , '''', '-')       ilike '%${vTPYC9BXPNn}%'  and   event.eventdatavalues  -> 'UuKat0HFjWS' ->> 'value' > '\"\\\"Positive\\\"\"'            group by tei_client.uid, \"R9Lw1uNtRuj\".value, \"TBt2a4Bq0Lx\".value  , \"BvsJfkddTgZ\".value, \"u57uh7lHwF8\".value  , \"vTPYC9BXPNn\".value, pi_client.enrollmentdate, tei_client.created    ORDER BY tei_client.created    ","displayName":"LSDescoveryAndDesign_SearchPositiveClient","publicAccess":"rw------","type":"QUERY","externalAccess":false,"cacheStrategy":"RESPECT_SYSTEM_SETTING","favorite":false,"lastUpdatedBy":{"id":"EXc0WvNU0Hu"},"access":{"read":true,"update":true,"externalize":true,"delete":true,"write":true,"manage":true},"user":{"id":"EXc0WvNU0Hu"},"favorites":[],"userGroupAccesses":[],"attributeValues":[],"translations":[],"userAccesses":[]}]}